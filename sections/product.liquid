{% comment %}
  Oxford Theme - Product Gallery Section
  Autor: Kleyver Urbina - kleyvercell2@gmail.com
  Versión mejorada: Minimalista y moderna
  Fecha: Enero 2025
{% endcomment %}

<section class="product-gallery-section" 
         style="background: {{ section.settings.background_color }}; 
                padding-top: {{ section.settings.padding_top }}px; 
                padding-bottom: {{ section.settings.padding_bottom }}px;">
  
  <div class="container">
    
    <!-- Breadcrumb -->
    {% if section.settings.show_breadcrumb %}
      <nav class="breadcrumb" aria-label="Breadcrumb">
        <ol class="breadcrumb-list">
          <li class="breadcrumb-item">
            <a href="{{ routes.root_url }}" class="breadcrumb-link">
              {{ 'general.breadcrumbs.home' | t | default: 'Inicio' }}
            </a>
          </li>
          
          {% if collection %}
            <li class="breadcrumb-item">
              <span class="breadcrumb-separator" aria-hidden="true">/</span>
              <a href="{{ collection.url }}" class="breadcrumb-link">
                {{ collection.title }}
              </a>
            </li>
          {% elsif product.collections.size > 0 %}
            <li class="breadcrumb-item">
              <span class="breadcrumb-separator" aria-hidden="true">/</span>
              <a href="{{ product.collections.first.url }}" class="breadcrumb-link">
                {{ product.collections.first.title }}
              </a>
            </li>
          {% endif %}
          
          <li class="breadcrumb-item">
            <span class="breadcrumb-separator" aria-hidden="true">/</span>
            <span class="breadcrumb-current" aria-current="page">
              {{ product.title }}
            </span>
          </li>
        </ol>
      </nav>
    {% endif %}
    
    <div class="product-wrapper">
      
      <!-- Galería de imágenes -->
      <div class="gallery-column">
        {% assign featured_image = product.featured_image | default: product.images.first %}
        <!-- Imagen principal -->
        {% if featured_image %}
          <div class="main-image-container">
            <img id="mainImage" 
                 class="main-image" 
                 src="{{ featured_image | image_url }}" 
                 alt="{{ product.title }}"
                 loading="eager">
            {% if section.settings.enable_zoom %}
              <div class="zoom-indicator">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <circle cx="11" cy="11" r="8"/>
                  <path d="m21 21-4.35-4.35"/>
                  <path d="M15 11h-8M11 15v-8"/>
                </svg>
              </div>
            {% endif %}
          </div>
        {% endif %}
        
        <!-- Otras imágenes (no carrusel, solo grid simple) -->
        {% if product.images.size > 1 %}
          <div class="product-thumbnails-grid">
            {% assign thumbnails_shown = 0 %}
            {% for image in product.images %}
              {% unless image == featured_image %}
                {% if thumbnails_shown < 6 %}
                  <div class="product-thumbnail-item">
                    <img src="{{ image | image_url }}" alt="{{ product.title }} - Imagen {{ forloop.index }}" loading="lazy">
                  </div>
                  {% assign thumbnails_shown = thumbnails_shown | plus: 1 %}
                {% endif %}
              {% endunless %}
            {% endfor %}
          </div>
        {% endif %}
      </div>
      
      <!-- Contenido del producto -->
      <div class="content-column">
        <div class="product-info">
          
          {% if section.settings.show_vendor and product.vendor != blank %}
            <div class="product-vendor">{{ product.vendor }}</div>
          {% endif %}
          
          <h1 class="product-title">
            {{ section.settings.custom_title | default: product.title }}
          </h1>
          
          {% if section.settings.custom_subtitle != blank %}
            <p class="product-subtitle">{{ section.settings.custom_subtitle }}</p>
          {% endif %}
          
          {% if section.settings.show_price %}
            <div class="product-price">
              {% if product.compare_at_price > product.price %}
                <span class="price-sale">{{ product.price | money }}</span>
                <span class="price-compare">{{ product.compare_at_price | money }}</span>
              {% else %}
                <span class="price-regular">{{ product.price | money }}</span>
              {% endif %}
            </div>
          {% endif %}
          
          {% if section.settings.show_description and product.description != blank %}
            <div class="product-description">
              {{ section.settings.custom_description | default: product.description }}
            </div>
          {% endif %}
          
          <!-- Bloques personalizados -->
          {% for block in section.blocks %}
            <div class="custom-block" {{ block.shopify_attributes }}>
              {% case block.type %}
                {% when 'whatsapp' %}
                  {% assign phone_number = block.settings.phone_number | remove: '+' | remove: ' ' | remove: '-' %}
                  {% assign whatsapp_message = block.settings.whatsapp_message | url_encode %}
                  
                  <div class="whatsapp-button"
                       style="--bubble-bg: {{ block.settings.bubble_bg_color }}; 
                              --button-bg: {{ block.settings.button_bg_color }}; 
                              --button-hover: {{ block.settings.button_hover_color }};">
                    <div class="whatsapp-message">
                      {{ block.settings.message_text }}
                      <div class="boton-linea">
                        <a href="https://api.whatsapp.com/send/?phone={{ phone_number }}&text={{ whatsapp_message }}" 
                           class="whatsapp-action-btn" 
                           target="_blank" 
                           rel="noopener" 
                           aria-label="{{ block.settings.button_text }}">
                          {{ block.settings.button_text }}
                        </a>
                      </div>
                    </div>
                    <button class="whatsapp-icon" 
                            aria-label="Chatea por WhatsApp" 
                            onclick="window.open('https://api.whatsapp.com/send/?phone={{ phone_number }}&text={{ whatsapp_message }}', '_blank')" 
                            type="button">
                      <svg viewBox="-1.5 0 259 259" xmlns="http://www.w3.org/2000/svg" fill="#FFFFFF">
                        <g>
                          <path d="M67.6631045,221.823373 L71.8484512,223.916047 C89.2873956,234.379413 108.819013,239.262318 128.350631,239.262318 L128.350631,239.262318 C189.735716,239.262318 239.959876,189.038158 239.959876,127.653073 C239.959876,98.3556467 228.101393,69.7557778 207.17466,48.8290445 C186.247927,27.9023111 158.345616,16.0438289 128.350631,16.0438289 C66.9655467,16.0438289 16.7413867,66.2679889 17.4389445,128.350631 C17.4389445,149.277365 23.7169645,169.50654 34.1803311,186.945485 L36.9705622,191.130831 L25.8096378,232.28674 L67.6631045,221.823373 Z" fill="#00E676"></path>
                          <path d="M219.033142,37.66812 C195.316178,13.2535978 162.530962,0 129.048189,0 C57.8972956,0 0.697557778,57.8972956 1.39511556,128.350631 C1.39511556,150.67248 7.67313556,172.296771 18.1365022,191.828389 L0,258.096378 L67.6631045,240.657433 C86.4971645,251.1208 107.423898,256.003705 128.350631,256.003705 L128.350631,256.003705 C198.803967,256.003705 256.003705,198.106409 256.003705,127.653073 C256.003705,93.4727423 242.750107,61.3850845 219.033142,37.66812 Z M129.048189,234.379413 L129.048189,234.379413 C110.214129,234.379413 91.380069,229.496509 75.3362401,219.7307 L71.1508934,217.638027 L30.6925422,228.101393 L41.1559089,188.3406 L38.3656778,184.155253 C7.67313556,134.628651 22.3218489,69.05822 72.5460089,38.3656778 C122.770169,7.67313556 187.643042,22.3218489 218.335585,72.5460089 C249.028127,122.770169 234.379413,187.643042 184.155253,218.335585 C168.111425,228.798951 148.579807,234.379413 129.048189,234.379413 Z M190.433273,156.9505 L182.760138,153.462711 C182.760138,153.462711 171.599213,148.579807 164.623636,145.092018 C163.926078,145.092018 163.22852,144.39446 162.530962,144.39446 C160.438289,144.39446 159.043173,145.092018 157.648058,145.789576 L157.648058,145.789576 C157.648058,145.789576 156.9505,146.487133 147.184691,157.648058 C146.487133,159.043173 145.092018,159.740731 143.696902,159.740731 L142.999345,159.740731 C142.301787,159.740731 140.906671,159.043173 140.209113,158.345616 L136.721325,156.9505 L136.721325,156.9505 C129.048189,153.462711 122.072611,149.277365 116.492149,143.696902 C115.097033,142.301787 113.00436,140.906671 111.609245,139.511556 C106.72634,134.628651 101.843436,129.048189 98.3556467,122.770169 L97.658089,121.375053 C96.9605312,120.677496 96.9605312,119.979938 96.2629734,118.584822 C96.2629734,117.189707 96.2629734,115.794591 96.9605312,115.097033 C96.9605312,115.097033 99.7507623,111.609245 101.843436,109.516571 C103.238551,108.121456 103.936109,106.028782 105.331225,104.633667 C106.72634,102.540993 107.423898,99.7507623 106.72634,97.658089 C106.028782,94.1703001 97.658089,75.3362401 95.5654156,71.1508934 C94.1703001,69.05822 92.7751845,68.3606623 90.6825112,67.6631045 L88.5898378,67.6631045 C87.1947223,67.6631045 85.1020489,67.6631045 83.0093756,67.6631045 C81.6142601,67.6631045 80.2191445,68.3606623 78.8240289,68.3606623 L78.1264712,69.05822 C76.7313556,69.7557778 75.3362401,71.1508934 73.9411245,71.8484512 C72.5460089,73.2435667 71.8484512,74.6386823 70.4533356,76.0337978 C65.5704312,82.3118178 62.7802,89.9849534 62.7802,97.658089 L62.7802,97.658089 C62.7802,103.238551 64.1753156,108.819013 66.2679889,113.701918 L66.9655467,115.794591 C73.2435667,129.048189 81.6142601,140.906671 92.7751845,151.370038 L95.5654156,154.160269 C97.658089,156.252942 99.7507623,157.648058 101.145878,159.740731 C115.794591,172.296771 132.535978,181.365022 151.370038,186.247927 C153.462711,186.945485 156.252942,186.945485 158.345616,187.643042 L158.345616,187.643042 C160.438289,187.643042 163.22852,187.643042 165.321193,187.643042 C168.808982,187.643042 172.994329,186.247927 175.78456,184.852811 C177.877233,183.457696 179.272349,183.457696 180.667465,182.06258 L182.06258,180.667465 C183.457696,179.272349 184.852811,178.574791 186.247927,177.179676 C187.643042,175.78456 189.038158,174.389445 189.735716,172.994329 C191.130831,170.204098 191.828389,166.716309 192.525947,163.22852 C192.525947,161.833405 192.525947,159.740731 192.525947,158.345616 C192.525947,158.345616 191.828389,157.648058 190.433273,156.9505 Z" fill="#FFFFFF"></path>
                        </g>
                      </svg>
                    </button>
                  </div>

                {% when 'text' %}
                  <div class="text-block">
                    {% if block.settings.heading != blank %}
                      <h3>{{ block.settings.heading }}</h3>
                    {% endif %}
                    {{ block.settings.text }}
                  </div>
                
                {% when 'button' %}
                  <a href="{{ block.settings.button_url }}" 
                     class="custom-button {{ block.settings.button_style }}">
                    {{ block.settings.button_text }}
                  </a>
                
                {% when 'html' %}
                  {{ block.settings.html_content }}
                
                {% when 'custom_offer' %}
                  {% comment %} Bloque de oferta personalizado - Solo informativo {% endcomment %}
                  {% assign offer_text = product.metafields.custom.offer_text.value | default: block.settings.offer_text %}
                  {% assign offer_active = product.metafields.custom.offer_active.value | default: block.settings.offer_active %}
                  {% assign offer_discount = product.metafields.custom.offer_discount.value | default: block.settings.offer_discount %}
                  {% assign countdown_date = product.metafields.custom.offer_countdown.value | default: block.settings.countdown_date %}
                  
                  {% if block.settings.show_offer_block and offer_active and offer_text != blank %}
                    <div class="custom-offer-block" style="
                      --offer-bg-color: {{ block.settings.offer_bg_color }};
                      --offer-text-color: {{ block.settings.offer_text_color }};
                      --offer-border-color: {{ block.settings.offer_border_color }};
                      --offer-badge-color: {{ block.settings.offer_badge_color }};
                      --offer-discount-bg: {{ block.settings.offer_discount_bg }};
                      --offer-discount-text: {{ block.settings.offer_discount_text }};
                      --countdown-bg-color: {{ block.settings.countdown_bg_color }};
                      --countdown-text-color: {{ block.settings.countdown_text_color }};
                    ">
                      <div class="custom-offer-content">
                        <div class="custom-offer-badge">
                          <svg viewBox="0 0 24 24">
                            <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                          </svg>
                        </div>
                        
                        <div class="custom-offer-text">
                          {{ offer_text }}
                        </div>
                        
                        {% if offer_discount and offer_discount > 0 %}
                          <div class="custom-offer-discount">
                            {{ offer_discount }}% OFF
                          </div>
                        {% endif %}
                      </div>
                      
                      {% if block.settings.show_countdown and countdown_date != blank %}
                        <div class="custom-offer-countdown">
                          ⏰ Oferta termina en: 
                          <div class="countdown-timer" data-countdown-end="{{ countdown_date }}">
                            <span class="countdown-unit">00</span>:
                            <span class="countdown-unit">00</span>:
                            <span class="countdown-unit">00</span>
                          </div>
                        </div>
                      {% endif %}
                    </div>
                  {% endif %}
                
                {% when 'add_to_cart' %}
                  {% comment %} Obtener precios para descuentos nativos de Shopify {% endcomment %}
                  {% assign current_variant = product.selected_or_first_available_variant %}
                  {% unless current_variant %}
                    {% assign current_variant = product.variants.first %}
                  {% endunless %}
                  {% assign variant_price = current_variant.price | default: product.price | default: 0 %}
                  {% assign variant_compare_at_price = current_variant.compare_at_price | default: 0 %}
                  


                  <div class="add-to-cart-block" 
                       data-product-id="{{ product.id }}" 
                       data-product-price="{{ variant_price }}"
                       data-compare-at-price="{{ variant_compare_at_price }}"
                       data-max-stock="{{ product.selected_or_first_available_variant.inventory_quantity | default: 999 }}"
                       style="--quantity-btn-color: {{ block.settings.quantity_btn_color | default: '#6b7280' }}; --quantity-btn-bg: {{ block.settings.quantity_btn_bg | default: 'transparent' }}; --quantity-label-color: {{ block.settings.quantity_label_color | default: '#374151' }}; --quantity-input-color: {{ block.settings.quantity_input_color | default: '#111827' }}; --quantity-input-bg: {{ block.settings.quantity_input_bg | default: 'transparent' }}; --price-total-label-color: {{ block.settings.price_total_label_color | default: '#374151' }}; --price-total-value-color: {{ block.settings.price_total_value_color | default: '#111827' }}; --threshold-warning-bg: {{ block.settings.threshold_warning_bg_color | default: '#fef3c7' }}; --threshold-warning-text: {{ block.settings.threshold_warning_text_color | default: '#92400e' }}; --threshold-warning-border: {{ block.settings.threshold_warning_border_color | default: '#f59e0b' }};">
                    {% if product.available %}
                      <!-- Debug: Mostrar información de variantes -->
                      <div style="background: #f0f0f0; padding: 10px; margin: 10px 0; font-size: 12px; border-radius: 4px;">
                        <strong>Debug Info:</strong><br>
                        - Producto: {{ product.title }}<br>
                        - Total variantes: {{ product.variants.size }}<br>
                        - Solo variante por defecto: {{ product.has_only_default_variant }}<br>
                        - Opciones disponibles: {{ product.options.size }}<br>
                        {% for option in product.options %}
                          - Opción {{ forloop.index }}: {{ option }} ({{ product.options_with_values[forloop.index0].values.size }} valores)<br>
                        {% endfor %}
                      </div>

                      <!-- Selector de Variantes -->
                      {% unless product.has_only_default_variant %}
                        <div class="product-variants" data-product-variants>
                          {% for option in product.options_with_values %}
                            <div class="variant-option">
                              <label class="variant-label">{{ option.name }}:</label>
                              <div class="variant-selector" data-option-name="{{ option.name }}" data-option-position="{{ option.position }}">
                                {% for value in option.values %}
                                  <input type="radio" 
                                         id="option-{{ option.position }}-{{ value | handle }}-{{ block.id }}" 
                                         name="option{{ option.position }}" 
                                         value="{{ value }}" 
                                         class="variant-input"
                                         {% if forloop.first %}checked{% endif %}
                                         data-variant-option>
                                  <label for="option-{{ option.position }}-{{ value | handle }}-{{ block.id }}" 
                                         class="variant-value">{{ value }}</label>
                                {% endfor %}
                              </div>
                            </div>
                          {% endfor %}
                        </div>
                      {% else %}
                        <div style="background: #fff3cd; padding: 10px; margin: 10px 0; border-radius: 4px; color: #856404;">
                          <strong>Aviso:</strong> Este producto solo tiene la variante por defecto. Para mostrar el selector de variantes, necesitas crear variantes adicionales en el admin de Shopify.
                        </div>
                      {% endunless %}

                      <form class="product-form" data-product-form>
                        <div class="quantity-selector">
                          <label for="quantity-{{ block.id }}" class="quantity-label">
                            {{ block.settings.quantity_label | default: 'Cantidad' }}:
                          </label>
                          <div class="quantity-input-wrapper">
                            <button type="button" class="quantity-btn quantity-minus" data-quantity-change="-1">
                              <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                                <path d="M5 12H19" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                              </svg>
                            </button>
                            <input type="number" 
                                   id="quantity-{{ block.id }}" 
                                   name="quantity" 
                                   value="1" 
                                   min="1" 
                                   max="{{ product.selected_or_first_available_variant.inventory_quantity | default: 999 }}" 
                                   class="quantity-input" 
                                   data-quantity-input>
                            <button type="button" class="quantity-btn quantity-plus" data-quantity-change="1">
                              <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                                <path d="M12 5V19M5 12H19" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                              </svg>
                            </button>
                          </div>
                        </div>
                        
                        <div class="price-total-display">
                          <span class="price-total-label">Total:</span>
                          <span class="price-total-value" data-price-total>$0.00</span>
                          <div class="shopify-discount-info" data-discount-info style="display: none; margin-top: 12px; padding: 12px; background: #e74c3c; border-radius: 8px; font-size: 14px; color: white; box-shadow: 0 2px 8px rgba(231, 76, 60, 0.3);">
                            <div class="discount-badge" style="display: flex; align-items: center; gap: 8px; margin-bottom: 6px;">
                              <span style="background: rgba(255,255,255,0.2); padding: 2px 8px; border-radius: 12px; font-size: 12px; font-weight: bold;">OFERTA</span>
                              <span class="discount-text">¡<strong data-discount-amount>0%</strong> de descuento!</span>
                            </div>
                            <div class="savings-display" style="font-size: 13px; opacity: 0.9;">
                              <span class="savings-text">💰 Ahorras: <strong data-savings-amount>$0.00</strong></span>
                            </div>
                          </div>
                        </div>
                        
                        <div class="cart-actions">
                          <button type="submit" 
                                  class="add-to-cart-btn" 
                                  data-add-to-cart
                                  style="background-color: {{ block.settings.button_bg_color | default: 'var(--nav-link-color, #007bff)' }}; color: {{ block.settings.button_text_color | default: '#ffffff' }};">
                            <span class="btn-text">{{ block.settings.add_to_cart_text | default: 'Agregar al carrito' }}</span>
                            <span class="btn-loading" style="display: none;">
                              <svg class="spinner" width="16" height="16" viewBox="0 0 24 24" fill="none">
                                <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" stroke-dasharray="31.416" stroke-dashoffset="31.416" opacity="0.3"/>
                                <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" stroke-dasharray="31.416" stroke-dashoffset="15.708"/>
                              </svg>
                              {{ block.settings.loading_text | default: 'Agregando...' }}
                            </span>
                          </button>
                          
                          <!-- Mensaje de stock -->
                          <div class="stock-message" data-stock-message style="display: none; color: #dc3545; font-size: 0.875rem; margin-top: 0.5rem; padding: 0.5rem; background-color: #f8d7da; border: 1px solid #f5c6cb; border-radius: 0.25rem;"></div>

                        </div>
                        

                        
                        <input type="hidden" name="id" value="{{ product.selected_or_first_available_variant.id }}" data-variant-id>
                      </form>
                    {% else %}
                      <div class="product-unavailable">
                        <span class="unavailable-text">{{ block.settings.unavailable_text | default: 'Producto no disponible' }}</span>
                      </div>
                    {% endif %}
                  </div>
                  
              {% endcase %}
            </div>
          {% endfor %}
          
        </div>
      </div>
      
    </div>
  </div>
</section>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const mainImage = document.getElementById('mainImage');
  const thumbnails = Array.from(document.querySelectorAll('.product-thumbnail-item img'));
  let currentIndex = 0;

  function updateMainImage(index) {
    if (!thumbnails[index]) return;
    mainImage.src = thumbnails[index].src;
    currentIndex = index;
  }

  thumbnails.forEach((thumb, i) => {
    thumb.addEventListener('click', () => updateMainImage(i));
  });

  // Zoom opcional
  {% if section.settings.enable_zoom %}
  let isZoomed = false;
  mainImage.addEventListener('click', () => {
    isZoomed = !isZoomed;
    mainImage.classList.toggle('zoomed', isZoomed);
  });
  mainImage.addEventListener('mouseleave', () => {
    if (isZoomed) {
      isZoomed = false;
      mainImage.classList.remove('zoomed');
    }
  });
  {% endif %}

  // Inicializar
  updateMainImage(0);
  
  // Product data for add-to-cart functionality
  {% if product %}
    window.product = {
      id: {{ product.id }},
      title: {{ product.title | json }},
      handle: {{ product.handle | json }},
      variants: [
        {% for variant in product.variants %}
          {
            id: {{ variant.id }},
            title: {{ variant.title | json }},
            price: {{ variant.price }},
            compare_at_price: {{ variant.compare_at_price | default: 0 }},
            available: {{ variant.available | json }},
            inventory_quantity: {{ variant.inventory_quantity | default: 999 }},
            inventory_policy: {{ variant.inventory_policy | json }},
            options: [
              {% for option in variant.options %}
                {{ option | json }}{% unless forloop.last %},{% endunless %}
              {% endfor %}
            ],
            featured_image: {% if variant.featured_image %}{{ variant.featured_image | image_url | json }}{% else %}null{% endif %}
          }{% unless forloop.last %},{% endunless %}
        {% endfor %}
      ],
      options: [
        {% for option in product.options %}
          {{ option | json }}{% unless forloop.last %},{% endunless %}
        {% endfor %}
      ]
    };

    // Funcionalidad de variantes
    function initVariantSelector() {
      const variantInputs = document.querySelectorAll('[data-variant-option]');
      const variantIdInput = document.querySelector('[data-variant-id]');
      const priceDisplay = document.querySelector('[data-price-total]');
      const quantityInput = document.querySelector('[data-quantity-input]');
      const addToCartBlock = document.querySelector('.add-to-cart-block');

      if (!variantInputs.length) return;

      function getSelectedOptions() {
        const options = [];
        for (let i = 1; i <= window.product.options.length; i++) {
          const selectedInput = document.querySelector(`input[name="option${i}"]:checked`);
          if (selectedInput) {
            options.push(selectedInput.value);
          }
        }
        return options;
      }

      function findVariantByOptions(options) {
        return window.product.variants.find(variant => {
          return variant.options.every((option, index) => option === options[index]);
        });
      }

      function updateVariant() {
        const selectedOptions = getSelectedOptions();
        const variant = findVariantByOptions(selectedOptions);

        if (variant) {
          // Actualizar ID de variante
          if (variantIdInput) {
            variantIdInput.value = variant.id;
          }

          // Actualizar precio
          if (priceDisplay && quantityInput) {
            const quantity = parseInt(quantityInput.value) || 1;
            const totalPrice = (variant.price * quantity) / 100;
            priceDisplay.textContent = `$${totalPrice.toFixed(2)}`;
          }

          // Actualizar imagen principal si la variante tiene imagen
          if (variant.featured_image && mainImage) {
            mainImage.src = variant.featured_image;
          }

          // Actualizar stock máximo
          if (quantityInput) {
            quantityInput.max = variant.inventory_quantity || 999;
          }

          // Actualizar datos del bloque
          if (addToCartBlock) {
            addToCartBlock.setAttribute('data-product-price', variant.price);
            addToCartBlock.setAttribute('data-compare-at-price', variant.compare_at_price || 0);
            addToCartBlock.setAttribute('data-max-stock', variant.inventory_quantity || 999);
          }

          // Verificar disponibilidad
          const addToCartBtn = document.querySelector('[data-add-to-cart]');
          if (addToCartBtn) {
            if (variant.available) {
              addToCartBtn.disabled = false;
              const btnText = addToCartBtn.querySelector('.btn-text');
              if (btnText) btnText.textContent = 'Agregar al carrito';
            } else {
              addToCartBtn.disabled = true;
              const btnText = addToCartBtn.querySelector('.btn-text');
              if (btnText) btnText.textContent = 'No disponible';
            }
          }
        }
      }

      // Event listeners para cambios de variante
      variantInputs.forEach(input => {
        input.addEventListener('change', () => {
          updateVariant();
          // Actualizar también el cálculo de precio total
          const quantityInput = document.querySelector('[data-quantity-input]');
          if (quantityInput && window.AddToCart) {
            const form = quantityInput.closest('form');
            if (form) {
              // Trigger price update in AddToCart class
              const event = new Event('change');
              quantityInput.dispatchEvent(event);
            }
          }
        });
      });

      // Event listener para cambios de cantidad
      if (quantityInput) {
        quantityInput.addEventListener('input', updateVariant);
      }

      // Inicializar con la primera variante
      updateVariant();
    }

    // Inicializar selector de variantes
    initVariantSelector();
  {% endif %}
});
</script>

<style>
/* Variables CSS */
:root {
  --primary-color: {{ section.settings.primary_color | default: '#000000' }};
  --secondary-color: {{ section.settings.secondary_color | default: '#666666' }};
  --accent-color: {{ section.settings.accent_color | default: '#007bff' }};
  --border-color: {{ section.settings.border_color | default: '#e5e5e5' }};
  --border-radius: {{ section.settings.border_radius | default: 8 }}px;
  --spacing-sm: 0.5rem;
  --spacing-md: 1rem;
  --spacing-lg: 2rem;
  --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Layout principal */
.product-gallery-section {
  width: 100%;
  min-height: 50vh;
}

.container {
  max-width: {{ section.settings.max_width | default: 1200 }}px;
  margin: 0 auto;
  padding: 0 var(--spacing-md);
}

/* Breadcrumb */
.breadcrumb {
  margin-bottom: var(--spacing-lg);
}

.breadcrumb-list {
  display: flex;
  flex-wrap: wrap;
  align-items: center;
  list-style: none;
  padding: 0;
  margin: 0;
  font-size: 0.875rem;
}

.breadcrumb-item {
  display: flex;
  align-items: center;
}

.breadcrumb-link {
  color: var(--secondary-color);
  text-decoration: none;
  transition: var(--transition);
  padding: 4px 0;
}

.breadcrumb-link:hover {
  color: var(--accent-color);
  text-decoration: underline;
}

.breadcrumb-separator {
  margin: 0 var(--spacing-sm);
  color: var(--secondary-color);
  opacity: 0.6;
}

.breadcrumb-current {
  color: var(--primary-color);
  font-weight: 500;
  max-width: 200px;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.product-wrapper {
  display: grid;
  grid-template-columns: 1fr;
  gap: var(--spacing-lg);
  align-items: start;
}

@media (min-width: 768px) {
  .product-wrapper {
    grid-template-columns: 1fr 1fr;
    gap: {{ section.settings.columns_gap | default: 60 }}px;
  }
}

/* Galería de imágenes */
.gallery-column {
  display: flex;
  flex-direction: column;
  gap: var(--spacing-md);
}

.main-image-container {
  position: relative;
  aspect-ratio: {{ section.settings.image_ratio | default: '1/1' }};
  border-radius: var(--border-radius);
  overflow: hidden;
  background: #f8f9fa;
  {% if section.settings.image_shadow %}
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
  {% endif %}
}

.main-image {
  width: 100%;
  height: 100%;
  object-fit: {{ section.settings.image_fit | default: 'cover' }};
  transition: var(--transition);
  cursor: {% if section.settings.enable_zoom %}zoom-in{% else %}default{% endif %};
}

.main-image.zoomed {
  transform: scale(1.5);
  cursor: zoom-out;
}

.zoom-indicator {
  position: absolute;
  top: var(--spacing-sm);
  right: var(--spacing-sm);
  background: rgba(255, 255, 255, 0.9);
  border-radius: 50%;
  width: 32px;
  height: 32px;
  display: flex;
  align-items: center;
  justify-content: center;
  opacity: 0.7;
  transition: var(--transition);
}

.main-image-container:hover .zoom-indicator {
  opacity: 1;
}

/* Thumbnails reemplazados por grid simple */
.product-thumbnails-grid {
  display: flex;
  flex-wrap: wrap;
  gap: 12px;
  margin-top: 1rem;
}

.product-thumbnail-item {
  flex: 0 0 auto;
  width: 80px;
  height: 80px;
  border-radius: calc(var(--border-radius) / 2);
  overflow: hidden;
  border: 2px solid var(--border-color);
  background: #fff;
  display: flex;
  align-items: center;
  justify-content: center;
}

.product-thumbnail-item img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  display: block;
}

/* Navegación mejorada */
.nav-btn {
  position: absolute;
  top: 50%;
  transform: translateY(-50%);
  background: rgba(255, 255, 255, 0.95);
  border: 1px solid var(--border-color);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: var(--transition);
  z-index: 2;
  backdrop-filter: blur(4px);
}

@media (max-width: 767px) {
  .nav-btn {
    width: 32px;
    height: 32px;
  }
  
  .nav-prev { left: -16px; }
  .nav-next { right: -16px; }
}

@media (min-width: 768px) {
  .nav-btn {
    width: 36px;
    height: 36px;
  }
  
  .nav-prev { left: -18px; }
  .nav-next { right: -18px; }
}

.nav-btn:hover {
  background: var(--accent-color);
  color: white;
  border-color: var(--accent-color);
  transform: translateY(-50%) scale(1.1);
}

/* Smooth scrolling para touch */
.thumbnails-track {
  -webkit-overflow-scrolling: touch;
  scroll-behavior: smooth;
}

/* Prevenir selección de texto durante swipe */
.thumbnails-track,
.main-image {
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  -webkit-touch-callout: none;
}

/* Contenido del producto */
.content-column {
  display: flex;
  flex-direction: column;
}

.product-info {
  display: flex;
  flex-direction: column;
  gap: var(--spacing-md);
}

.product-vendor {
  font-size: 0.875rem;
  color: var(--secondary-color);
  text-transform: uppercase;
  letter-spacing: 0.5px;
  font-weight: 500;
}

.product-title {
  font-size: {{ section.settings.title_size | default: 2 }}rem;
  font-weight: {{ section.settings.title_weight | default: 700 }};
  color: var(--primary-color);
  line-height: 1.2;
  margin: 0;
}

.product-subtitle {
  font-size: 1.125rem;
  color: var(--secondary-color);
  line-height: 1.4;
  margin: 0;
}

.product-price {
  display: flex;
  align-items: center;
  gap: var(--spacing-sm);
  font-size: 1.5rem;
  font-weight: 600;
}

.price-sale {
  color: var(--accent-color);
}

.price-compare {
  color: var(--secondary-color);
  text-decoration: line-through;
  font-size: 1.25rem;
  font-weight: 400;
}

.product-description {
  color: var(--secondary-color);
  line-height: 1.6;
  font-size: 1rem;
}

/* Bloques personalizados */
.custom-block {
  margin: var(--spacing-md) 0;
}

.text-block h3 {
  margin: 0 0 var(--spacing-sm) 0;
  color: var(--primary-color);
  font-size: 1.25rem;
}

.custom-button {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  padding: 12px 24px;
  border-radius: var(--border-radius);
  text-decoration: none;
  font-weight: 600;
  transition: var(--transition);
  cursor: pointer;
  border: none;
  font-size: 1rem;
}

.custom-button.primary {
  background: var(--accent-color);
  color: white;
}

.custom-button.secondary {
  background: transparent;
  color: var(--accent-color);
  border: 2px solid var(--accent-color);
}

.custom-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
}

/* Responsive */
@media (max-width: 767px) {
  .container {
    padding: 0 var(--spacing-sm);
  }
  
  .breadcrumb {
    margin-bottom: var(--spacing-md);
  }
  
  .breadcrumb-list {
    font-size: 0.8rem;
  }
  
  .breadcrumb-current {
    max-width: 150px;
  }
  
  .product-title {
    font-size: 1.5rem;
  }
  
  .product-thumbnail-item {
    width: 60px;
    height: 60px;
  }
  
  .nav-btn {
    width: 32px;
    height: 32px;
  }
  
  .nav-prev { left: -16px; }
  .nav-next { right: -16px; }
}

@media (min-width: 768px) {
  .product-title {
    font-size: 2rem;
  }
  
  .product-thumbnail-item {
    width: 80px;
    height: 80px;
  }
  
  .nav-btn {
    width: 36px;
    height: 36px;
  }
  
  .nav-prev { left: -18px; }
  .nav-next { right: -18px; }
}

/* Animaciones */
@keyframes fadeInUp {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.product-info > * {
  animation: fadeInUp 0.6s ease-out;
}

/* Estilos del selector de variantes */
.product-variants {
  margin-bottom: 1.5rem;
  padding: 1rem;
  background: #f8f9fa;
  border-radius: var(--border-radius);
  border: 1px solid var(--border-color);
}

.variant-option {
  margin-bottom: 1rem;
}

.variant-option:last-child {
  margin-bottom: 0;
}

.variant-label {
  display: block;
  font-weight: 600;
  color: var(--primary-color);
  margin-bottom: 0.5rem;
  font-size: 0.9rem;
}

.variant-selector {
  display: flex;
  flex-wrap: wrap;
  gap: 0.5rem;
}

.variant-input {
  display: none;
}

.variant-value {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  padding: 0.5rem 1rem;
  border: 2px solid var(--border-color);
  border-radius: 25px;
  background: white;
  color: var(--secondary-color);
  font-size: 0.875rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.3s ease;
  min-width: 60px;
  text-align: center;
}

.variant-value:hover {
  border-color: var(--accent-color);
  color: var(--accent-color);
  transform: translateY(-1px);
  box-shadow: 0 2px 8px rgba(0, 123, 255, 0.15);
}

.variant-input:checked + .variant-value {
  background: var(--accent-color);
  border-color: var(--accent-color);
  color: white;
  font-weight: 600;
  box-shadow: 0 2px 8px rgba(0, 123, 255, 0.3);
}

.variant-input:disabled + .variant-value {
  opacity: 0.5;
  cursor: not-allowed;
  background: #f5f5f5;
  color: #999;
}

.variant-input:disabled + .variant-value:hover {
  transform: none;
  box-shadow: none;
  border-color: var(--border-color);
}

/* Responsive para variantes */
@media (max-width: 767px) {
  .product-variants {
    margin-bottom: 1rem;
    padding: 0.75rem;
  }
  
  .variant-value {
    padding: 0.4rem 0.8rem;
    font-size: 0.8rem;
    min-width: 50px;
  }
  
  .variant-selector {
    gap: 0.4rem;
  }
}

.product-info > *:nth-child(1) { animation-delay: 0.1s; }
.product-info > *:nth-child(2) { animation-delay: 0.2s; }
.product-info > *:nth-child(3) { animation-delay: 0.3s; }
.product-info > *:nth-child(4) { animation-delay: 0.4s; }

/* Estilos del botón de WhatsApp */
.whatsapp-button {
  display: block;
  margin: 0;
  padding: 0;
}

.whatsapp-icon {
  background-color: #25d366;
  color: white;
  border-radius: 50%;
  width: 60px;
  height: 60px;
  display: flex;
  justify-content: center;
  align-items: center;
  box-shadow: 0 4px 8px rgba(0,0,0,0.3);
  transition: all 0.3s ease;
  text-decoration: none;
  border: none;
  cursor: pointer;
  outline: none;
}

.whatsapp-icon:hover {
  transform: scale(1.1);
  box-shadow: 0 6px 12px rgba(0,0,0,0.35);
}

.whatsapp-icon svg {
  width: 35px;
  height: 35px;
}

.whatsapp-message {
  background-color: #333;
  color: white;
  padding: 12px 18px 16px 18px;
  border-radius: 20px;
  margin-bottom: 10px;
  box-shadow: 0 4px 8px rgba(0,0,0,0.2);
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  max-width: 240px;
  position: relative;
  opacity: 1;
  transform: translateY(0);
  pointer-events: auto;
  border: 2px solid #25d366;
  text-align: left;
  display: flex;
  flex-direction: column;
  gap: 10px;
  align-items: flex-start;
  transition: all 0.3s ease;
}

.whatsapp-message .boton-linea {
  display: flex;
  align-items: center;
  gap: 0;
  margin-top: 6px;
}

.whatsapp-message:after {
  content: '';
  position: absolute;
  bottom: -10px;
  left: 20px;
  width: 0;
  height: 0;
  border-left: 10px solid transparent;
  border-right: 10px solid transparent;
  border-top: 10px solid #333;
}

.whatsapp-action-btn {
  background: #25d366;
  color: white;
  border: none;
  border-radius: 16px;
  padding: 8px 16px;
  cursor: pointer;
  font-weight: 600;
  font-size: 1em;
  transition: background 0.2s;
  text-decoration: none;
  display: inline-block;
  white-space: nowrap;
}

.whatsapp-action-btn:hover {
  background: #1db954;
}

@media (max-width: 768px) {
  .whatsapp-icon {
    width: 50px;
    height: 50px;
  }
  .whatsapp-icon svg {
    width: 30px;
    height: 30px;
  }
  .whatsapp-message {
    max-width: 180px;
    font-size: 0.93em;
  }
}
</style>


{% schema %}
 {
  "name": "Galería de Producto",
  "tag": "section",
  "class": "product-gallery-section",
  "settings": [
    {
      "type": "header",
      "content": "🧭 Navegación"
    },
    {
      "type": "checkbox",
      "id": "show_breadcrumb",
      "label": "Mostrar breadcrumb (migajas de pan)",
      "default": true
    },
    {
      "type": "header",
      "content": "📐 Diseño y Layout"
    },
    {
      "type": "range",
      "id": "max_width",
      "min": 1000,
      "max": 1400,
      "step": 50,
      "unit": "px",
      "label": "Ancho máximo del contenedor",
      "default": 1200
    },
    {
      "type": "range",
      "id": "columns_gap",
      "min": 20,
      "max": 100,
      "step": 10,
      "unit": "px",
      "label": "Espacio entre columnas",
      "default": 60
    },
    {
      "type": "range",
      "id": "padding_top",
      "min": 0,
      "max": 100,
      "step": 5,
      "unit": "px",
      "label": "Espaciado superior",
      "default": 40
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "min": 0,
      "max": 100,
      "step": 5,
      "unit": "px",
      "label": "Espaciado inferior",
      "default": 40
    },
    {
      "type": "header",
      "content": "🎨 Colores"
    },
    {
      "type": "color",
      "id": "background_color",
      "label": "Color de fondo",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "primary_color",
      "label": "Color primario (títulos)",
      "default": "#000000"
    },
    {
      "type": "color",
      "id": "secondary_color",
      "label": "Color secundario (texto)",
      "default": "#666666"
    },
    {
      "type": "color",
      "id": "accent_color",
      "label": "Color de acento (botones, enlaces)",
      "default": "#007bff"
    },
    {
      "type": "color",
      "id": "border_color",
      "label": "Color de bordes",
      "default": "#e5e5e5"
    },
    {
      "type": "header",
      "content": "🖼️ Configuración de Imágenes"
    },
    {
      "type": "select",
      "id": "image_ratio",
      "options": [
        {
          "value": "1/1",
          "label": "Cuadrada (1:1)"
        },
        {
          "value": "4/3",
          "label": "Horizontal (4:3)"
        },
        {
          "value": "3/4",
          "label": "Vertical (3:4)"
        },
        {
          "value": "16/9",
          "label": "Panorámica (16:9)"
        }
      ],
      "default": "1/1",
      "label": "Proporción de imagen principal"
    },
    {
      "type": "select",
      "id": "image_fit",
      "options": [
        {
          "value": "cover",
          "label": "Cubrir (recortar si es necesario)"
        },
        {
          "value": "contain",
          "label": "Contener (mostrar imagen completa)"
        }
      ],
      "default": "cover",
      "label": "Ajuste de imagen"
    },
    {
      "type": "checkbox",
      "id": "image_shadow",
      "label": "Sombra en imagen principal",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "enable_zoom",
      "label": "Habilitar zoom en imagen",
      "default": true
    },
    {
      "type": "header",
      "content": "🔍 Miniaturas"
    },
    {
      "type": "range",
      "id": "thumbnail_size",
      "min": 60,
      "max": 120,
      "step": 10,
      "unit": "px",
      "label": "Tamaño de miniaturas",
      "default": 80
    },
    {
      "type": "range",
      "id": "thumbnails_per_row",
      "min": 3,
      "max": 6,
      "step": 1,
      "label": "Miniaturas visibles por fila",
      "default": 4
    },
    {
      "type": "header",
      "content": "📝 Contenido del Producto"
    },
    {
      "type": "text",
      "id": "custom_title",
      "label": "Título personalizado",
      "info": "Deja vacío para usar el título del producto"
    },
    {
      "type": "range",
      "id": "title_size",
      "min": 1.5,
      "max": 3,
      "step": 0.1,
      "unit": "rem",
      "label": "Tamaño del título",
      "default": 2
    },
    {
      "type": "select",
      "id": "title_weight",
      "options": [
        {
          "value": "400",
          "label": "Normal"
        },
        {
          "value": "500",
          "label": "Medio"
        },
        {
          "value": "600",
          "label": "Semi-negrita"
        },
        {
          "value": "700",
          "label": "Negrita"
        }
      ],
      "default": "700",
      "label": "Peso del título"
    },
    {
      "type": "text",
      "id": "custom_subtitle",
      "label": "Subtítulo personalizado"
    },
    {
      "type": "textarea",
      "id": "custom_description",
      "label": "Descripción personalizada",
      "info": "Deja vacío para usar la descripción del producto"
    },
    {
      "type": "header",
      "content": "👁️ Elementos Visibles"
    },
    {
      "type": "checkbox",
      "id": "show_vendor",
      "label": "Mostrar marca/proveedor",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_price",
      "label": "Mostrar precio",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_description",
      "label": "Mostrar descripción",
      "default": true
    },
    {
      "type": "header",
      "content": "🎯 Estilo"
    },
    {
      "type": "range",
      "id": "border_radius",
      "min": 0,
      "max": 20,
      "step": 2,
      "unit": "px",
      "label": "Radio de bordes redondeados",
      "default": 8
    }
  ],
  "blocks": [
    {
      "type": "whatsapp",
      "name": "💬 Botón de WhatsApp",
      "settings": [
        {
          "type": "text",
          "id": "phone_number",
          "label": "Número de WhatsApp",
          "default": "+584142145474",
          "info": "Incluye el código del país. Ejemplo: +584142145474"
        },
        {
          "type": "text",
          "id": "message_text",
          "label": "Texto de la burbuja",
          "default": "Cotiza nuestros precios al mayor 🚚"
        },
        {
          "type": "text",
          "id": "button_text",
          "label": "Texto del botón",
          "default": "Cotizar ahora"
        },
        {
          "type": "text",
          "id": "whatsapp_message",
          "label": "Mensaje predeterminado",
          "default": "¡Hola! Quisiera cotizar precios al mayor para sus productos ¿Me pueden ayudar? 🚚"
        },
        {
          "type": "color",
          "id": "bubble_bg_color",
          "label": "Color de fondo de la burbuja",
          "default": "#333333"
        },
        {
          "type": "color",
          "id": "button_bg_color",
          "label": "Color de fondo del botón",
          "default": "#25d366"
        },
        {
          "type": "color",
          "id": "button_hover_color",
          "label": "Color del botón al pasar el mouse",
          "default": "#1db954"
        }
      ]
    },
    {
      "type": "text",
      "name": "📄 Bloque de Texto",
      "settings": [
        {
          "type": "text",
          "id": "heading",
          "label": "Encabezado (opcional)"
        },
        {
          "type": "richtext",
          "id": "text",
          "label": "Contenido de texto"
        }
      ]
    },
    {
      "type": "button",
      "name": "🔘 Botón Personalizado",
      "settings": [
        {
          "type": "text",
          "id": "button_text",
          "label": "Texto del botón",
          "default": "Ver más"
        },
        {
          "type": "url",
          "id": "button_url",
          "label": "Enlace del botón"
        },
        {
          "type": "select",
          "id": "button_style",
          "options": [
            {
              "value": "primary",
              "label": "Primario (relleno)"
            },
            {
              "value": "secondary",
              "label": "Secundario (contorno)"
            }
          ],
          "default": "primary",
          "label": "Estilo del botón"
        }
      ]
    },
    {
      "type": "html",
      "name": "💻 HTML Personalizado",
      "settings": [
        {
          "type": "html",
          "id": "html_content",
          "label": "Código HTML personalizado"
        }
      ]
    },
    {
      "type": "custom_offer",
      "name": "🎯 Oferta Personalizada",
      "settings": [
        {
          "type": "header",
          "content": "Configuración de la Oferta"
        },
        {
          "type": "checkbox",
          "id": "offer_active",
          "label": "Activar oferta",
          "default": false,
          "info": "También se puede controlar desde metafields del producto"
        },
        {
          "type": "text",
          "id": "offer_text",
          "label": "Texto de la oferta",
          "default": "¡Oferta especial por tiempo limitado!",
          "info": "Se puede sobrescribir con el metafield 'custom.offer_text'"
        },
        {
          "type": "number",
          "id": "offer_discount",
          "label": "Porcentaje de descuento",
          "default": 15,
          "info": "Se puede sobrescribir con el metafield 'custom.offer_discount'"
        },
        {
          "type": "text",
          "id": "offer_label",
          "label": "Etiqueta de la oferta",
          "default": "OFERTA ESPECIAL"
        },
        {
          "type": "header",
          "content": "Colores y Estilo"
        },
        {
          "type": "color",
          "id": "offer_bg_color",
          "label": "Color de fondo",
          "default": "#e74c3c"
        },
        {
          "type": "color",
          "id": "offer_text_color",
          "label": "Color del texto",
          "default": "#ffffff"
        },
        {
          "type": "color",
          "id": "offer_border_color",
          "label": "Color del borde",
          "default": "#c0392b"
        },
        {
          "type": "color",
          "id": "offer_badge_color",
          "label": "Color del ícono/badge",
          "default": "#ffffff"
        },
        {
          "type": "color",
          "id": "offer_discount_bg",
          "label": "Color de fondo del descuento",
          "default": "rgba(255, 255, 255, 0.2)"
        },
        {
          "type": "color",
          "id": "offer_discount_text",
          "label": "Color del texto del descuento",
          "default": "#ffffff"
        },
        {
          "type": "color",
          "id": "countdown_bg_color",
          "label": "Color de fondo del countdown",
          "default": "rgba(255, 255, 255, 0.2)"
        },
        {
          "type": "color",
          "id": "countdown_text_color",
          "label": "Color del texto del countdown",
          "default": "#ffffff"
        },
        {
          "type": "checkbox",
          "id": "show_offer_block",
          "label": "Mostrar bloque de oferta",
          "default": true,
          "info": "Controla la visibilidad del bloque completo"
        },
        {
          "type": "header",
          "content": "Cuenta Regresiva (Opcional)"
        },
        {
          "type": "checkbox",
          "id": "show_countdown",
          "label": "Mostrar cuenta regresiva",
          "default": false
        },
        {
          "type": "text",
          "id": "countdown_date",
          "label": "Fecha límite",
          "placeholder": "2024-12-31T23:59:59",
          "info": "Formato: YYYY-MM-DDTHH:MM:SS"
        }
      ]
    },
    {
      "type": "add_to_cart",
      "name": "🛒 Agregar al carrito",
      "settings": [
        {
          "type": "header",
          "content": "Configuración general"
        },
        {
          "type": "text",
          "id": "quantity_label",
          "label": "Etiqueta de cantidad",
          "default": "Cantidad"
        },
        {
          "type": "header",
          "content": "Botón agregar al carrito"
        },
        {
          "type": "text",
          "id": "add_to_cart_text",
          "label": "Texto del botón",
          "default": "Agregar al carrito"
        },
        {
          "type": "text",
          "id": "loading_text",
          "label": "Texto de carga",
          "default": "Agregando..."
        },
        {
          "type": "color",
          "id": "button_bg_color",
          "label": "Color de fondo del botón",
          "default": "#007bff"
        },
        {
          "type": "color",
          "id": "button_text_color",
          "label": "Color del texto del botón",
          "default": "#ffffff"
        },
        {
          "type": "header",
          "content": "Botones de cantidad"
        },
        {
          "type": "color",
          "id": "quantity_btn_color",
          "label": "Color de los botones de cantidad",
          "default": "#6b7280"
        },
        {
          "type": "color",
          "id": "quantity_btn_bg",
          "label": "Color de fondo de los botones",
          "default": "transparent"
        },
        {
          "type": "color",
          "id": "quantity_label_color",
          "label": "Color del texto del label",
          "default": "#374151"
        },
        {
          "type": "color",
          "id": "quantity_input_color",
          "label": "Color del texto del input",
          "default": "#111827"
        },
        {
          "type": "color",
          "id": "quantity_input_bg",
          "label": "Color de fondo del input",
          "default": "transparent"
        },
        {
          "type": "header",
          "content": "Precio total"
        },
        {
          "type": "color",
          "id": "price_total_label_color",
          "label": "Color del texto 'Total:'",
          "default": "#374151"
        },
        {
          "type": "color",
          "id": "price_total_value_color",
          "label": "Color del precio total",
          "default": "#111827"
        },
        {
          "type": "text",
          "id": "unavailable_text",
          "label": "Texto cuando el producto no está disponible",
          "default": "Producto no disponible"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Galería de Producto",
      "blocks": [
        {
          "type": "text",
          "settings": {
            "heading": "Características",
            "text": "<p>Describe las características principales de tu producto aquí.</p>"
          }
        },
        {
          "type": "button",
          "settings": {
            "button_text": "Comprar Ahora",
            "button_style": "primary"
          }
        }
      ]
    }
  ],
  "disabled_on": {
    "groups": ["header", "footer"]
  }
}

{% endschema %}